<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitFriend</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <link rel="stylesheet" href="../static/css/stylesheet.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/bulma@0.9.2/js/bulma.min.js"> </script>

    <style>
        main {
            width: 1100px;
            margin: auto;
            padding: 20px;

        }

        table,
        th,
        tr {
            border: 3px solid cornflowerblue;
            border-collapse: collapse;
            color: white !important;
        }

        tr {
            text-align: center;
        }

        th {
            text-align: center;
            min-width: 157px;
            max-width: 157px;
        }

        .tile_title {
            font-size: 30px;
        }

        .content {
            font-size: 20px;
            margin-bottom: 0px !important;
        }

        .input {
            width: 100px;
        }

        textarea {
            min-width: 200px !important;
            max-width: 200px !important;
        }

        .tile.is-parent.is-vertical {
            padding: 0px !important;
        }

        .slot {
            height: 600px;
        }

        .container {
            width: 500px;
            clear: both;
            padding: 10px;
            border-color: white;
            align-content: right;
        }

        .label {
            color: white !important;
            /* float:left; */
            height: auto;
            font-size: 16px;
            line-height: center;
            width: 200px;
            align-content: center !important;
            /* clear: both; */
            margin: auto;

        }

        body {
            background-color: #303030;
        }

        section {
            width: 500px;
            height: 600px;
            border-color: white;
        }

        #createSession {
            color: #6ae9a5;
            font-weight: bold;
            font-size: 30px;
            text-align: center;
            margin-bottom: 15px;
        }

        .tile {
            min-width: 155px;
            max-width: 155px;
            position: relative;
        }

        /* .notification {
            position: relative;
            min-width: 155px;
            max-width: 155px;
        } */

        .invisible {
            top: 0;
            left: 0;
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;

        }

        select {
            width: 200px;
        }

        input {
            width: 200px !important;
        }

        #submit {
            margin: auto;
            margin-top: 30px;

            width: 200px;
        }

        .fill_up {
            width: 300px;
            margin: auto;
            padding: 20px;
            border: 2px solid #6ae9a5;
        }

        /* .hidden_value {
            display: none;
        } */

        /* #textarea {
            display: flex;
            
        } */

        /* #to-be-form { 
            border: 2px solid #6ae9a5; 
        } */
    </style>
    <script>

        //  ë¡œë”© í›„ ë°”ë¡œ í˜„ì¬ ìˆëŠ” ìš´ë™ì„¸ì…˜ë“¤ ëª¨ë‘ ë³´ì—¬ì¤Œ 
        // window.onload = todayDate; //, login_info;

        // //ë¡œê·¸ì¸ ì •ë³´ ë°›ì•„ì™€ì•¼ í•¨ (ì´í›„ sessioní•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ í•„ìš”)
        // // function login_info() {
        // //     type: "GET",
        // // username 
        // // userId
        // // }

        // // GETì„ í•  ìˆ˜ ìˆëŠ” URL ìƒì„± í•„ìš”? 



        // function start() {
        //     $(document).ready(function () {
        //         if ("{{session['name']}}" != ""); {
        //             const str = "{{session['name']}}"
        //             name = str.split();

        //         }
        //     })
        // }

        //     // $('#ì›”').empty()
        //     // $('#í™”').empty()
        //     // $('#ìˆ˜').empty()
        //     // $('#ëª©').empty()
        //     // $('#ê¸ˆ').empty()
        //     // $('#í† ').empty()
        //     // $('#ì¼').empty()

        //     // // $.ajax({
        //     //     type: "GET",
        //     //     url: "/tile",
        //     //     data: {},
        //     //     success: function (response) {
        //     //         let session_info = response["data"];
        //     //         console.log(session_info);
        //     //         for (let i = 0; i < session_info.length; i++) {
        //     //             let number = i
        //     //             let slot = (session_info[i]["day"]);
        //     //             make_tile(number, slot);
        //     //         }
        //     //     }
        //     // }
        //     // )

        // }

        // // // DBì•ˆ ë°ì´í„°ë¡œ íƒ€ì¼ì„ ìƒì„±
        // // function make_tile(number, day) {
        // //     let tempHtml =
        // //         // `<div class="tile">
        // //         //     <article class="tile is-child notification is-primary">
        // //         //         <p class="tile_title">${session_info[i]["name"]}</p>
        // //         //         <p class="tile_title">${session_info[i]["gender"]}</p>
        // //         //         <p class="content">${session_info[i]["field"]}</p>
        // //         //         <p class="content">1/${session_info[i]["max_member"]}</p>
        // //         //     </article>
        // //         // </div>`

        // //         // `<div class="tile">
        // //         //     <div class="tile is-parent is-vertical">
        // //         //         <article class="tile is-child notification is-primary">
        // //         //             <p class="tile_title">ë‚¨ì¬í¬</p>
        // //         //             <p class="tile_title">ë‚¨</p>
        // //         //             <p class="content">1ì‹œ ëŸ°ë‹</p>
        // //         //             <p class="content">(1/4)</p>
        // //         //         </article>
        // //         //     </div>
        // //         // </div>`


        // //         //     ì–´ë–»ê²Œ í•´ì•¼ ì œëŒ€ë¡œ ëœ ìœ„ì¹˜ì— ê°ˆ ì§€ í™•ì¸
        // //         // $("#" + day).append(tempHtml);


        // // }

        // function create_session() {
        //     // let userName = username;
        //     // let userId = userId;
        //     let day = $(#"post-day").val();
        //     let time = $("#post-time").val();
        //     let field = $("#post-field").val();
        //     let max_member = $("#post-max_member").val();
        //     // let note = $("#post-note").val(); //session.pyì—ì„œ ë…¸íŠ¸ ì¶”ê°€ë ë•Œê¹Œì§€ ëŒ€ê¸° - í˜„ì¬ ìƒíƒœì—ì„œ í™œì„±í™” ì‹œí‚¬ ì‹œ 404
        //     let result;

        //     //ê³„ì† ì‹¤íŒ¨ê°€ ëœ¸ - í„°ë¯¸ë„ì—ì„  201
        //     $.ajax({
        //         type: "POST",
        //         url: "/session",
        //         data: { day: day, time: time, field: field, max_member: max_member }, //note : note ëŠ” session.pyì—ì„œ ë…¸íŠ¸ ì¶”ê°€ë ë•Œê¹Œì§€ ëŒ€ê¸°
        //         //usernameê³¼ userIdì •ë³´ë„ ë³´ë‚´ë„ë¡ í•´ì•¼í•¨
        //         uccess: function (response) {
        //             if (response["result"] == "success") {
        //                 alert("ì„±ê³µ");

        //                 result = response["data"];
        //                 add_tile();
        //             } else {
        //                 alert("ì‹¤íŒ¨");
        //             }
        //         }
        //     })
        // }

        // // // íƒ€ì¼ ì¶”ê°€ì‹œí‚¤ëŠ” ë”ë¯¸í•¨ìˆ˜ - ì‘ë™ë¨
        // // // function make_dummy() {
        // // //     let tempHtml =
        // // //         `<div class="tile">
        // // //             <div class="tile is-parent is-vertical">
        // // //                 <article class="tile is-child notification is-primary">
        // // //                     <p class="tile_title">ë‚¨ì¬í¬</p>
        // // //                     <p class="tile_title">ë‚¨</p>
        // // //                     <p class="content">1ì‹œ ëŸ°ë‹</p>
        // // //                     <p class="content">(1/4)</p>
        // // //                 </article>
        // // //             </div>
        // // //         </div>`

        // // //     $('#í™”').append(tempHtml);
        // // // }

        // // //     function updateOnSunday() {
        // // //     // í˜„ì¬ ë‚ ì§œì™€ ì‹œê°„ ê°€ì ¸ì˜¤ê¸°
        // // //     const currentDate = new Date();
        // // //     const currentDay = currentDate.getDay(); // 0ì€ ì¼ìš”ì¼, 1ì€ ì›”ìš”ì¼, ...

        // // //     // ì—…ë°ì´íŠ¸ë¥¼ ì›í•˜ëŠ” ì‹œê°„ (24ì‹œê°„ í˜•ì‹)
        // // //     const updateHour = 24; // ì˜ˆì‹œë¡œ 24ì‹œê°„ìœ¼ë¡œ ì„¤ì •

        // // //     // ì¼ìš”ì¼ì´ê³  í˜„ì¬ ì‹œê°„ì´ ì—…ë°ì´íŠ¸ ì‹œê°„ë³´ë‹¤ ì´í›„ì¸ ê²½ìš°ì—ë§Œ ì—…ë°ì´íŠ¸ ìˆ˜í–‰
        // // //     if (currentDay === 0 && currentDate.getHours() >= updateHour) {
        // // //         // ì—¬ê¸°ì— ì‹¤ì œë¡œ ìˆ˜í–‰í•  ì—…ë°ì´íŠ¸ ë¡œì§ ì¶”ê°€
        // // //         console.log('Update logic executed on Sunday at', currentDate);
        // // //     }
        // // // }

        // // // // ë§¤ ë¶„ë§ˆë‹¤ updateOnSunday í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” setInterval
        // // // setInterval(updateOnSunday, 3600000); // 3600000ë°€ë¦¬ì´ˆ(60ë¶„) ê°„ê²©ìœ¼ë¡œ ì‹¤í–‰
        // function todayDate() {
        //     var fullDate = new Date(date),
        //         month = '' + (fullDate.getMonth() + 1),
        //         day = '' + fullDate.getDate(),
        //         year = fullDate.getFullYear();

        //     if (month.length < 2)
        //         month = '0' + month;
        //     if (day.length < 2)
        //         day = '0' + day;

        //     return [year, month, day];
        // }


        function participate_session(username, userid, sessionId) {
            $.ajax({
                type: 'POST',
                url: '/session/participate',
                data: { "userName": username, "userId": userid, "sessionId": sessionId },
                success: function (response) {
                    if (response['result'] == 'success') {
                        alert("ì°¸ì—¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
                        window.location.reload()
                    }
                    if (response['result'] == 'fail') {
                        alert(response["msg"]);
                    }
                }
            });
        }

        function except_session(username, userid, sessionId) {
            $.ajax({
                type: 'POST',
                url: '/session/quit',
                data: { "userName": username, "userId": userid, "sessionId": sessionId },
                success: function (response) {
                    if (response['result'] == 'success') {
                        alert("ì°¸ì—¬ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤!");
                        window.location.reload()
                    } else {
                        alert("ì—…ë°ì´íŠ¸ ì‹¤íŒ¨");
                    }
                }
            });
        }

        function delete_session(sessionId) {
            $.ajax({
                type: 'PUT',
                url: '/session/' + sessionId,
                data: {},
                success: function (response) {
                    if (response['result'] == 'success') {
                        alert("ì„¸ì…˜ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!");
                        window.location.reload()
                    }
                }
            });
        }


    </script>
</head>

<body>
    <header>
        <div class="logout" onclick="logout()">ğŸ“¤</div>
        <div class="guide-box">
            <a href="{{ url_for('guide')}}" id="userGuide">ì‚¬ìš© ê°€ì´ë“œ</a>
        </div>

        <div class="title">
            FitFriend
        </div>
    </header>

    <main>
        <div id="week_calendar">
            <table>
                <tr>
                    <th>Mon</th>
                    <th>Tue</th>
                    <th>Wed</th>
                    <th>Thu</th>
                    <th>Fri</th>
                    <th>Sat</th>
                    <th>Sun</th>
                </tr>
                <tr>
                    <th class="slot" id="ì›”">

                        <!-- <div class="tile is-parent is-vertical container">
                            <article class="tile is-child notification is-primary">
                                 Your tile content here -->
                        <p class="tile_title">{{ name }}</p>
                        <p class="content">{{ day }} + " " + {{ time }} </p>
                        <p class="content">{{ field }} + " " + {{ max_member }}</p>
                        <!-- Modal Structure
                                <div class="container">
                                    <div id="image-modal" class="modal">
                                        <div class="modal-background"></div>
                                        <div class="modal-content">
                                            <div class="modal-card">
                                                <header class="modal-card-head">
                                                    <p class="modal-card-title">Modal title</p>
                                                </header>
                                                <div class="modal-card-body">
                                                    {{ note }}
                                                </div>
                                                <footer class="modal-card-foot">
                                                    <button class="button is-success">Save changes</button>
                                                </footer>
                                            </div>
                                        </div>
                                    <button id="image-modal-close" class="modal-close"></button>
                                    </div>
                                    
                                </div>
                                <button class="invisible" id="showModal">Shows</button>
                            </article>
                        </div> -->




        </div>

        </th>
        <th class="slot" id="í™”"></th>
        <th class="slot" id="ìˆ˜"></th>
        <th class="slot" id="ëª©"></th>
        <th class="slot" id="ê¸ˆ"></th>
        <th class="slot" id="í† "></th>
        <th class="slot" id="ì¼"></th>
        </tr>
        </table>
        </div>
        <br>
        <section class="fill_up">
            <h2 class="header" id="createSession">ìš´ë™ ì„¸ì…˜ ìƒì„±</h2>
            <form id="to-be-form" method="post" action="/session">
                <div class="label">ìš”ì¼<br>
                    <div class="select is-primary">
                        <select name="day" id="post-day" placeholder="ìš”ì¼ì„ ì„ íƒí•˜ì„¸ìš”">
                            <optgroup label="ìš”ì¼ì„ ì„ íƒí•˜ì„¸ìš”">
                                <option value="MON">ì›”</option>
                                <option value="TUES">í™”</option>
                                <option value="WED">ìˆ˜</option>
                                <option value="THURS">ëª©</option>
                                <option value="FRI">ê¸ˆ</option>
                                <option value="SAT">í† </option>
                                <option value="SUN">ì¼</option>
                            </optgroup>
                        </select>
                    </div>
                </div>
                <div class="label">
                    ì‹œê°„ <br>
                    <div class="select is-primary">
                        <select id="post-time" placeholder="ì‹œê°„ì„ ì„ íƒí•˜ì„¸ìš”" name="time">
                            <!-- optgroup ì¤„ì¼ ìˆ˜ ìˆë‚˜ í™•ì¸ -->
                            <optgroup>
                                <option value="1">01:00</option>
                                <option value="2">02:00</option>
                                <option value="3">03:00</option>
                                <option value="4">04:00</option>
                                <option value="5">05:00</option>
                                <option value="6">06:00</option>
                                <option value="7">07:00</option>
                                <option value="8">08:00</option>
                                <option value="9">09:00</option>
                                <option value="10">10:00</option>
                                <option value="11">11:00</option>
                                <option value="12">12:00</option>
                                <option value="13">13:00</option>
                                <option value="14">14:00</option>
                                <option value="15">15:00</option>
                                <option value="16">16:00</option>
                                <option value="17">17:00</option>
                                <option value="18">18:00</option>
                                <option value="19">19:00</option>
                                <option value="20">20:00</option>
                                <option value="21">21:00</option>
                                <option value="22">22:00</option>
                                <option value="23">23:00</option>
                                <option value="24">24:00</option>
                            </optgroup>
                        </select>
                    </div>
                </div>
                <div class="label">
                    ìš´ë™ ì¢…ëª© <br>
                    <div class="select is-primary">
                        <select name="field" id="post-field" placeholder="ì¢…ëª©ì„ ì„ íƒí•˜ì„¸ìš”">
                            <optgroup label="ì¢…ëª©ì„ ì„ íƒí•˜ì„¸ìš”">
                                <option value="fitness">í—¬ìŠ¤</option>
                                <option value="running">ëŸ°ë‹</option>
                                <option value="swimming">ìˆ˜ì˜</option>
                                <option value="basketball">ë†êµ¬</option>
                            </optgroup>
                        </select>
                    </div>

                </div>
                </div>
                <div class="label">
                    ìµœëŒ€ ì¸ì› <br><input type="text" id="post-max_member" class="input is-primary" placeholder="ìµœëŒ€ ëª¨ì§‘ ì¸ì›"
                        name="max_member">
                    <div id="textarea" class="label"> ë¹„ê³  <br> <textarea id="post-note" cols="20" rows="2"
                            class="textarea is-primary" name="note"></textarea>
                    </div>
                    <div><input name="userName" class="hidden_value" value="{{ username }}" /></div>
                    <div><input name="userId" class="hidden_value" value="{{ userId }}" /></div>
                    <div><input name="date" class="hidden_value" id='dateInput' /></div>
                    <div class="label">
                        <label for="submit" class="label"> </label>
                        <button type="submit" id="submit" class="button is-primary">ì„¸ì…˜
                            ìƒì„±</button>
                    </div>
            </form>
        </section>


        <button type="submit"
            onclick="participate_session('ë¬¸ì„±ì¤€07', '659e435865388c3606d807cd', '659e9045d5c4898cd1352a36');">ì°¸ì—¬</button>
        <button type="submit" onclick="except_session(username, userId, sessionId);">ì·¨ì†Œ</button>
        <button type="submit" onclick="delete_session(sessionId);">ì‚­ì œ</button>
    </main>

</body>

<script>
    var btn = document.querySelector('#showModal');
    var modalDlg = document.querySelector('#image-modal');
    var imageModalCloseBtn = document.querySelector('#image-modal-close');
    btn.addEventListener('click', function () {
        console.log('hi');
        modalDlg.classList.add('is-active');
    });

    imageModalCloseBtn.addEventListener('click', function () {
        modalDlg.classList.remove('is-active');
    });
</script>
<script>
    $(document).ready(function () {
        const date = new Date();
        const year = date.getFullYear();
        const month = ('0' + (date.getMonth() + 1)).slice(-2);
        const day = ('0' + (date.getDate())).slice(-2);
        const today = `${year}${month}${day}`;

        $("#dateInput").val(today);
        console.log(today)
    });
</script>

</html>